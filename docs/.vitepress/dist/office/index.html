<!DOCTYPE html>
<html style="height: 100%">
  <head>
    <title>现在就试试</title>
    <!-- 纯演示 -->
  </head>
  <body style="height: 100%; margin: 0">
    <div id="placeholder" style="height: 100%"></div>
    <script
      type="text/javascript"
      src="http://www.dootask.com/office/web-apps/apps/api/documents/api.js?hash=0.22.22"
    ></script>

    <script type="text/javascript">
      function urlParse(url) {
        var obj = {};
        var reg = /[?&][^?&]+=[^?&]+/g;
        var arr = url.match(reg);
        // ['?id=12345','&a=b']
        if (arr) {
          for (var index = 0; index < arr.length; index++) {
            var item = arr[index];
            var tempArr = item.substr(1).split("=");
            var key = decodeURIComponent(tempArr[0]);
            var val = decodeURIComponent(tempArr[1]);
            obj[key] = val;
          }
        }
        return obj;
      }
      var query = urlParse(window.location.href);
      //   var url = "http://172.19.8.7:32005/1.docx";
      var url =
        "https://d2nlctn12v279m.cloudfront.net/assets/docs/samples/demo.docx";
      // https://d2nlctn12v279m.cloudfront.net/assets/docs/samples/demo.xlsx
      var key = "apiwh1ce9cf62-83b6-47dc-87a9-9111111";
      var name = "阿策";
      var mode = "edit";
      var documentType = "word";
      var fileType = "docx";

      var _url = query["file"];
      var _key = query["key"];
      var _name = query["name"];
      var _mode = query["mode"];
      var _documentType = query["documentType"];
      var _fileType = query["fileType"];

      if (_documentType === "word") {
        url =
          "https://d2nlctn12v279m.cloudfront.net/assets/docs/samples/demo.docx";
      }
      if (_documentType === "cell") {
        url =
          "https://d2nlctn12v279m.cloudfront.net/assets/docs/samples/demo.xlsx";
      }
      if (_documentType === "slide") {
        url =
          "https://d2nlctn12v279m.cloudfront.net/assets/docs/samples/demo.pptx";
      }

      if (_url) {
        url = _url;
      }

      if (_key) {
        key = _key;
      }

      if (_name) {
        name = _name;
      }

      if (_mode) {
        mode = _mode;
      }

      if (_documentType) {
        documentType = _documentType;
      }

      if (_fileType) {
        fileType = _fileType;
      }

      window.docEditor = new DocsAPI.DocEditor("placeholder", {
        document: {
          fileType: fileType,
          key: key,
          permissions: {
            // review: false,
            edit: true,
            fillForms: true,
            modifyFilter: true,
            modifyContentControl: true,
          },
          title: "现在就试试",
          url: url,
        },
        documentType: documentType,
        editorConfig: {
          lang: "zh",
          // callbackUrl: 'https:\/\/api.onlyoffice.com\/zh\/editors\/callback',
          customization: {
            anonymous: { request: false },
            spellcheck: false,
            plugins: false,
          },
          user: {
            group: "",
            id: key + name,
            name: name,
          },
          mode: mode,
        },
        height: "100%",
        width: "100%",
      });
    </script>
  </body>
</html>
